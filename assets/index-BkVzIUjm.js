var t=Object.defineProperty,e=(e,s,a)=>((e,s,a)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a)(e,"symbol"!=typeof s?s+"":s,a);import{r as s}from"./phaser-UvlxNa5i.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();var a=s();class r extends a.Scene{constructor(){super("Boot")}preload(){this.load.image("background","assets/bg.png")}create(){this.scene.start("Preloader")}}class i extends a.Scene{constructor(){super("Preloader")}init(){this.add.image(512,384,"background"),this.add.rectangle(512,384,468,32).setStrokeStyle(1,16777215);const t=this.add.rectangle(282,384,4,28,16777215);this.load.on("progress",(e=>{t.width=4+460*e}))}preload(){this.load.setPath("assets"),this.load.image("logo","logo.png")}create(){this.scene.start("TestScene")}}class o extends Phaser.Scene{constructor(){super("TestScene"),e(this,"gameWidth",352),e(this,"gameHeight",240),e(this,"mapImages"),e(this,"platforms"),e(this,"map"),e(this,"character"),e(this,"cursors"),e(this,"playerState","IDLE"),e(this,"isPlayerMovingHorizontally"),e(this,"isPlayerTouchingGround"),e(this,"keyboardInputs"),e(this,"weaponState"),e(this,"sword")}preload(){this.loadAssets()}loadAssets(){this.loadMapAssets(),this.loadCharacterMovementAssets(),this.loadCharacterAttackAssets(),this.loadWeaponsAssets()}loadMapAssets(){this.load.image("platform","https://labs.phaser.io/assets/sprites/platform.png"),this.load.tilemapTiledJSON("canyon_map","assets/maps/canyon.json"),this.loadMapImages()}loadCharacterMovementAssets(){this.load.spritesheet("spr_idle","assets/characters/otomo/v1/spr_idle.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("spr_running","assets/characters/otomo/v1/spr_running.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("spr_jump","assets/characters/otomo/v1/spr_jump.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("spr_look_up","assets/characters/otomo/v1/spr_lookup.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("spr_look_down","assets/characters/otomo/v1/spr_lookdown.png",{frameWidth:16,frameHeight:16})}loadCharacterAttackAssets(){this.load.spritesheet("spr_attack_sword","assets/characters/otomo/v1/spr_shortattack.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("spr_attack_sword_up","assets/characters/otomo/v1/spr_shortattackup.png",{frameWidth:16,frameHeight:16}),this.load.spritesheet("spr_attack_sword_down","assets/characters/otomo/v1/spr_shortattackdown.png",{frameWidth:16,frameHeight:16})}loadWeaponsAssets(){for(let t=0;t<5;t++)this.load.image(`spr_sword_${t}`,`assets/sprites/combat/melee/spr_sword/spr_sword_${t}.png`);this.load.spritesheet("spr_sword_idle","assets/sprites/combat/melee/spr_sword/spr_sword_0.png",{frameWidth:16,frameHeight:16})}create(){this.createMap(),this.createTitle(),this.createCharacter(),this.createKeyboardInputs(),this.createWeapons()}update(){this.updateCharacterMovement(),this.updateWeaponsPosition(),this.updateCharacterAttack()}loadMapImages(){this.mapImages=["bg_FG_0","at_bgrock_0","bg_rock_0","bg_bamboo_0","spr_bamboo_1","spr_grass_group_1","spr_grass_group_2","bg_forestrock_0"],this.mapImages.forEach((t=>{this.load.image(t,`assets/sprites/maps/${t}.png`)}))}createTitle(){this.add.text(16,16,"Slash Out Level Test",{fontStyle:"bold",fontSize:"14px",color:"#fff"})}createMap(){this.map=this.make.tilemap({key:"canyon_map"});const t=[];this.mapImages.forEach((e=>{const s=this.map.addTilesetImage(e,e);s&&t.push(s)})),this.createMapLayer("background",t);const e=this.createMapLayer("ground",t);this.platforms=e.find((t=>null==t?void 0:t.layer.name.includes("platform"))),this.platforms.setCollisionByProperty({collider:!0}),this.createMapLayer("foreground",t)}createMapLayer(t,e){return this.map.layers.filter((e=>e.name.startsWith(`${t}/`))).map((t=>this.map.createLayer(t.name,e,0,0)))}createCharacter(){this.character=this.physics.add.sprite(150,100,"spr_idle"),this.createCharacterCollisions(),this.createCharacterAnimations()}createCharacterCollisions(){this.character.setCollideWorldBounds(!0),this.physics.add.collider(this.character,this.platforms)}createCharacterAnimations(){this.createCharacterMovementAnimations(),this.createCharacterAttackAnimations()}createCharacterMovementAnimations(){this.anims.create({key:"anim_idle",frames:this.anims.generateFrameNumbers("spr_idle",{start:0,end:0}),frameRate:7,repeat:-1}),this.anims.create({key:"anim_running",frames:this.anims.generateFrameNumbers("spr_running",{start:0,end:1}),frameRate:6,repeat:-1}),this.anims.create({key:"anim_look_up",frames:this.anims.generateFrameNumbers("spr_look_up",{start:0,end:0}),frameRate:7,repeat:-1}),this.anims.create({key:"anim_look_down",frames:this.anims.generateFrameNumbers("spr_look_down",{start:0,end:0}),frameRate:7,repeat:-1}),this.anims.create({key:"anim_jump",frames:this.anims.generateFrameNumbers("spr_jump",{start:1,end:2}),frameRate:12}),this.anims.create({key:"anim_in_air",frames:this.anims.generateFrameNumbers("spr_jump",{start:2,end:2}),frameRate:12})}createCharacterAttackAnimations(){this.anims.create({key:"anim_attack_sword",frames:this.anims.generateFrameNumbers("spr_attack_sword",{start:0,end:0}),frameRate:7,repeat:-1}),this.anims.create({key:"anim_attack_sword_up",frames:this.anims.generateFrameNumbers("spr_attack_sword_up",{start:0,end:0}),frameRate:7,repeat:-1}),this.anims.create({key:"anim_attack_sword_down",frames:this.anims.generateFrameNumbers("spr_attack_sword_down",{start:0,end:0}),frameRate:7,repeat:-1})}createWeaponsAnimations(){this.anims.create({key:"anims_attack_sword_trail",frames:[{key:"spr_sword_0"},{key:"spr_sword_1"},{key:"spr_sword_2"},{key:"spr_sword_3"},{key:"spr_sword_4"}],frameRate:2,repeat:-1}),this.add.sprite(400,300,"spr_sword_0").play("anims_attack_sword_trail")}setPlayerState(t){if(this.playerState!==t)switch(this.playerState=t,t){case"IDLE":this.character.anims.play("anim_idle",!0);break;case"RUNNING":this.character.anims.play("anim_running",!0);break;case"JUMPING":this.character.anims.play("anim_jump",!0);break;case"IN_AIR":this.character.anims.play("anim_in_air",!0);break;case"LOOKING_UP":this.character.anims.play("anim_look_up",!0);break;case"LOOKING_DOWN":this.character.anims.play("anim_look_down",!0);break;case"ATTACKING":this.character.anims.play("anim_attack_sword",!0);break;case"ATTACKING_UP":this.character.anims.play("anim_attack_sword_up",!0);break;case"ATTACKING_DOWN":this.character.anims.play("anim_attack_sword_down",!0)}}setWeaponState(t){if(this.weaponState!==t)switch(this.weaponState=t,t){case"SWORD_FORWARD":case"SWORD_UP":case"SWORD_DOWN":this.sword.anims.play("anims_attack_sword_trail",!0)}}createKeyboardInputs(){const t=this.input.keyboard;this.cursors=this.input.keyboard.createCursorKeys(),this.keyboardInputs={left:t.addKey("A"),right:t.addKey("D"),up:t.addKey("W"),down:t.addKey("S"),jump:t.addKey("SPACE"),attack:t.addKey("F"),dash:t.addKey("SHIFT")}}createWeapons(){this.sword=this.physics.add.sprite(this.character.x,this.character.y,"spr_sword_0"),this.sword.setVisible(!1),this.createWeaponsAnimations(),this.createWeaponCollisions()}createWeaponCollisions(){this.sword.setCollideWorldBounds(!0),this.sword.body.allowGravity=!1,this.physics.add.overlap(this.sword,this.character),this.physics.add.overlap(this.sword,this.platforms)}updateCharacterMovement(){this.character&&this.cursors&&(this.isPlayerMovingHorizontally=this.cursors.left.isDown||this.keyboardInputs.left.isDown||this.cursors.right.isDown||this.keyboardInputs.right.isDown,this.isPlayerTouchingGround=this.character.body.blocked.down,this.updateHorizontalMovement(),this.updateVerticalMovement())}updateHorizontalMovement(){this.cursors.left.isDown||this.keyboardInputs.left.isDown?(this.character.setVelocityX(-100),this.character.setFlipX(!0),this.isPlayerTouchingGround&&this.setPlayerState("RUNNING")):this.cursors.right.isDown||this.keyboardInputs.right.isDown?(this.character.setVelocityX(100),this.character.setFlipX(!1),this.isPlayerTouchingGround&&this.setPlayerState("RUNNING")):this.isPlayerTouchingGround&&!this.isPlayerMovingHorizontally&&(this.character.setVelocityX(0),this.setPlayerState("IDLE"))}updateVerticalMovement(){Phaser.Input.Keyboard.JustDown(this.cursors.space)&&this.isPlayerTouchingGround&&(this.character.setVelocityY(-450),this.setPlayerState("JUMPING")),this.isPlayerTouchingGround||this.setPlayerState("IN_AIR"),(this.cursors.up.isDown||this.keyboardInputs.up.isDown)&&!this.isPlayerMovingHorizontally&&this.isPlayerTouchingGround?this.setPlayerState("LOOKING_UP"):(this.cursors.down.isDown||this.keyboardInputs.down.isDown)&&!this.isPlayerMovingHorizontally&&this.isPlayerTouchingGround&&this.setPlayerState("LOOKING_DOWN")}updateWeaponsPosition(){this.updateSwordPosition()}updateSwordPosition(){let t=this.character.x,e=this.character.y,s=0,a=48,r=24;"LOOKING_UP"===this.playerState?(s=-90,a=24,r=48,t=this.character.x,e=this.character.y-this.character.height/2-r/2):"LOOKING_DOWN"===this.playerState?(s=90,a=24,r=48,t=this.character.x,e=this.character.y+this.character.height/2+r/2):(this.character.flipX?(s=180,t=this.character.x-this.character.width/2-a/2):(s=0,t=this.character.x+this.character.width/2+a/2),e=this.character.y),this.sword.setOrigin(.5,.5),this.sword.setAngle(s),this.sword.body.setSize(a,r),this.sword.setPosition(t,e)}updateCharacterAttack(){this.keyboardInputs.attack.isDown?(this.sword.setVisible(!0),"LOOKING_UP"===this.playerState?this.setPlayerState("ATTACKING_UP"):"LOOKING_DOWN"===this.playerState?this.setPlayerState("ATTACKING_DOWN"):this.setPlayerState("ATTACKING")):this.sword&&this.sword.setVisible(!1)}updateSwordAttack(){this.keyboardInputs.attack.isDown&&("LOOKING_UP"===this.playerState?this.setWeaponState("SWORD_UP"):"LOOKING_DOWN"===this.playerState?this.setWeaponState("SWORD_DOWN"):this.setWeaponState("SWORD_FORWARD"))}}const h={type:a.AUTO,width:352,height:240,parent:"game-container",backgroundColor:"#00000",physics:{default:"arcade",arcade:{gravity:{x:0,y:1300},debug:!0}},scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},render:{pixelArt:!0,antialias:!1},input:{keyboard:!0},scene:[r,i,o]};document.addEventListener("DOMContentLoaded",(()=>{new a.Game({...h,parent:"game-container"})}));
